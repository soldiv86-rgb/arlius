-- FRUIT LOOP VARIABLES
local fruitName = "Carrot [0.38kg]" -- change to your fruit
local petUUID = "{9c8926b2-0362-4019-85e7-905ea7a8433a}"
local loopActive = false

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local PetsService = ReplicatedStorage.GameEvents.PetsService
local FavoriteRemote = ReplicatedStorage.GameEvents.Favorite_Item
local localPlayer = Players.LocalPlayer

-- START LOOP
local function startFruitLoop()
    if loopActive then return end
    loopActive = true

    task.spawn(function()
        while loopActive do
            local fruit = localPlayer.Backpack:FindFirstChild(fruitName)
            if fruit then
                FavoriteRemote:FireServer(fruit)
            end
            task.wait(0.2) -- cooldown
        end
    end)

    print("ðŸ”¥ Fruit loop started")
end

-- STOP LOOP
local function stopFruitLoop()
    if loopActive then
        loopActive = false
        print("ðŸ›‘ Fruit loop stopped")
    end
end

-- HOOK FireServer TO DETECT PET EQUIP/UNEQUIP
local old; old = hookmetamethod(game, "__namecall", function(self, ...)
    local args = {...}

    if self == PetsService and getnamecallmethod() == "FireServer" then
        -- START loop on EquipPet
        if args[1] == "EquipPet" and tostring(args[2]) == petUUID then
            print("EquipPet detected â†’ starting fruit loop")
            startFruitLoop()
        end

        -- STOP loop on UnequipPet
        if args[1] == "UnequipPet" and tostring(args[2]) == petUUID then
            print("UnequipPet detected â†’ stopping fruit loop")
            stopFruitLoop()
        end
    end

    return old(self, ...)
end)
